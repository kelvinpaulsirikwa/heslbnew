document.addEventListener('DOMContentLoaded',function(){const fullHeader=document.getElementById('full-header');const compactHeader=document.getElementById('compact-header');const headerSpacer=document.getElementById('header-spacer');const mobileMenuBtn=document.getElementById('mobileMenuBtn');const mobileNavOverlay=document.getElementById('mobileNavOverlay');const closeNavBtn=document.getElementById('closeNavBtn');let lastScrollTop=0;let headerTransitioned=false;let fullHeaderHeight=0;let isScrolling=false;function calculateHeaderHeight(){if(fullHeader){fullHeaderHeight=fullHeader.offsetHeight;}}calculateHeaderHeight();let scrollTimeout;window.addEventListener('scroll',function(){if(scrollTimeout){clearTimeout(scrollTimeout);}const scrollTop=window.pageYOffset||document.documentElement.scrollTop;isScrolling=true;scrollTimeout=setTimeout(function(){isScrolling=false;},100);if(window.innerWidth>=992){const threshold=fullHeaderHeight*0.8;if(scrollTop>threshold&&!headerTransitioned){fullHeader.classList.add('hidden');headerSpacer.classList.add('active');setTimeout(()=>{compactHeader.classList.add('show');},200);headerTransitioned=true;}else if(scrollTop<=threshold*0.6&&headerTransitioned){compactHeader.classList.remove('show');setTimeout(()=>{fullHeader.classList.remove('hidden');headerSpacer.classList.remove('active');},200);headerTransitioned=false;}}lastScrollTop=scrollTop;});mobileMenuBtn?.addEventListener('click',function(){mobileNavOverlay.classList.add('show');document.body.style.overflow='hidden';});closeNavBtn?.addEventListener('click',closeMobileNav);mobileNavOverlay?.addEventListener('click',function(e){if(e.target===mobileNavOverlay){closeMobileNav();}});function closeMobileNav(){mobileNavOverlay.classList.remove('show');document.body.style.overflow='';document.querySelectorAll('.nav-section-header.active').forEach(header=>{header.classList.remove('active');const subsection=header.nextElementSibling;if(subsection){subsection.classList.remove('show');subsection.style.maxHeight='0px';}});}window.addEventListener('resize',function(){calculateHeaderHeight();if(window.innerWidth>=992){closeMobileNav();if(window.pageYOffset<=fullHeaderHeight*0.8){fullHeader.classList.remove('hidden');compactHeader.classList.remove('show');headerSpacer.classList.remove('active');headerTransitioned=false;}}else{compactHeader.classList.add('show');compactHeader.classList.remove('mobile-hidden');fullHeader.classList.add('hidden');headerSpacer.classList.remove('active');headerTransitioned=true;}});document.addEventListener('keydown',function(e){if(e.key==='Escape'&&mobileNavOverlay.classList.contains('show')){closeMobileNav();}});if(window.innerWidth<992){compactHeader.classList.add('show');compactHeader.classList.remove('mobile-hidden');fullHeader.classList.add('hidden');headerTransitioned=true;}document.querySelectorAll('.dropdown-toggle').forEach(function(toggle){toggle.addEventListener('click',function(e){e.preventDefault();});});document.querySelectorAll('.dropdown').forEach(function(dropdown){let hoverTimeout;dropdown.addEventListener('mouseenter',function(){clearTimeout(hoverTimeout);const menu=this.querySelector('.dropdown-menu');if(menu){menu.style.display='block';setTimeout(()=>{menu.classList.add('show');},10);}});dropdown.addEventListener('mouseleave',function(){const menu=this.querySelector('.dropdown-menu');if(menu){menu.classList.remove('show');hoverTimeout=setTimeout(()=>{menu.style.display='none';},300);}});});initializeMobileDropdowns();});function initializeMobileDropdowns(){document.querySelectorAll('.nav-section-header').forEach(function(header){header.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();toggleMobileDropdown(this);});});document.querySelectorAll('.nav-section-header').forEach(function(header){header.classList.remove('active');const subsection=header.nextElementSibling;if(subsection){subsection.classList.remove('show');subsection.style.maxHeight='0px';}});}function toggleMobileDropdown(element){const subsection=element.nextElementSibling;const isActive=element.classList.contains('active');document.querySelectorAll('.nav-section-header.active').forEach(header=>{if(header!==element){header.classList.remove('active');header.setAttribute('aria-expanded','false');const otherSubsection=header.nextElementSibling;if(otherSubsection){otherSubsection.classList.remove('show');otherSubsection.style.maxHeight='0px';}}});if(isActive){element.classList.remove('active');element.setAttribute('aria-expanded','false');if(subsection){subsection.classList.remove('show');subsection.style.maxHeight='0px';}}else{element.classList.add('active');element.setAttribute('aria-expanded','true');if(subsection){const scrollHeight=subsection.scrollHeight;subsection.style.maxHeight=(scrollHeight+100)+'px';subsection.classList.add('show');setTimeout(()=>{if(subsection.classList.contains('show')){subsection.style.maxHeight='none';}},500);}}}function recalculateDropdownHeights(){document.querySelectorAll('.nav-subsection.show').forEach(function(subsection){const scrollHeight=subsection.scrollHeight;subsection.style.maxHeight=(scrollHeight+100)+'px';});}function changeLanguage(locale){window.location.href=`/lang/${locale}`;}